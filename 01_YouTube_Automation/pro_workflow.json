{"name": "Pro YouTube Automation Agent","nodes": [{"parameters": {},"id": "trigger","name": "Start","type": "n8n-nodes-base.manualTrigger","typeVersion": 1,"position": [ -380, 0 ]},{"parameters": {"model": "gpt-4o","messages": {"values": [{"role": "system","content": "You are a professional documentary filmmaker. Output a strict JSON array. No markdown.\nStructure:\n[\n  {\n    "scene_id": 1,\n    "voiceover": "Text...",\n    "visual_prompt": "Image prompt..."\n  }\n]"},{"content": "Create a 3-scene script about 'The History of Coffee'."}]}},"id": "gpt-node","name": "AI Script Generator","type": "n8n-nodes-base.openAi","typeVersion": 1,"position": [ -160, 0 ],"credentials": {"openAiApi": {"id": "YOUR_OPENAI_ID","name": "OpenAI account"}}},{"parameters": {"jsCode": "const content = $input.first().json.message.content;\nconst cleanJson = content.replace(/`json/g, '').replace(/`/g, '');\nreturn JSON.parse(cleanJson);"},"id": "parse-node","name": "Parse JSON","type": "n8n-nodes-base.code","typeVersion": 2,"position": [ 60, 0 ]},{"parameters": {"batchSize": 1,"options": {}},"id": "split-node","name": "Split Scenes Loop","type": "n8n-nodes-base.splitInBatches","typeVersion": 3,"position": [ 280, 0 ]},{"parameters": {"method": "POST","url": "https://api.elevenlabs.io/v1/text-to-speech/YOUR_VOICE_ID","sendHeaders": true,"headerParameters": {"parameters": [{"name": "xi-api-key","value": "YOUR_ELEVENLABS_KEY"},{"name": "Content-Type","value": "application/json"}]},"sendBody": true,"bodyParameters": {"parameters": [{"name": "text","value": "={{ $json.voiceover }}"},{"name": "model_id","value": "eleven_monolingual_v1"}]},"options": {"response": {"response": {"responseFormat": "file"}}}},"id": "elevenlabs-node","name": "ElevenLabs (Binary)","type": "n8n-nodes-base.httpRequest","typeVersion": 4.1,"position": [ 540, -100 ]},{"parameters": {"bucketName": "YOUR_BUCKET_NAME","fileName": "={{ 'audio_' + $node["Split Scenes Loop"].json["scene_id"] + '.mp3' }}","options": {"acl": "public-read"}},"id": "s3-audio-node","name": "Upload Audio to S3","type": "n8n-nodes-base.awsS3","typeVersion": 2,"position": [ 740, -100 ],"credentials": {"aws": {"id": "YOUR_AWS_ID","name": "AWS Account"}}},{"parameters": {"method": "POST","url": "https://api.replicate.com/v1/predictions","sendHeaders": true,"headerParameters": {"parameters": [{"name": "Authorization","value": "Token YOUR_REPLICATE_KEY"},{"name": "Content-Type","value": "application/json"}]},"sendBody": true,"bodyParameters": {"parameters": [{"name": "version","value": "flux-pro-hash"},{"name": "input","value": "={{ {"prompt": $node["Split Scenes Loop"].json["visual_prompt"]} }}"}]},"options": {}},"id": "replicate-start","name": "Start Image Gen","type": "n8n-nodes-base.httpRequest","typeVersion": 4.1,"position": [ 940, -100 ]},{"parameters": {"amount": 10,"unit": "seconds"},"id": "wait-node","name": "Wait for Gen","type": "n8n-nodes-base.wait","typeVersion": 1,"position": [ 1140, -100 ],"webhookId": "cb315e98-1234-4567-8901-234567890123"},{"parameters": {"url": "={{ $json.urls.get }}","sendHeaders": true,"headerParameters": {"parameters": [{"name": "Authorization","value": "Token YOUR_REPLICATE_KEY"}]},"options": {}},"id": "replicate-check","name": "Get Image URL","type": "n8n-nodes-base.httpRequest","typeVersion": 4.1,"position": [ 1340, -100 ]},{"parameters": {"jsCode": "// Aggregate Data\nconst audioUrl = $('Upload Audio to S3').first().json.Location;\nconst duration = 5; \nconst imageUrl = $('Get Image URL').first().json.output[0];\n\nreturn {\n  scene_id: $node["Split Scenes Loop"].json["scene_id"],\n  audio_url: audioUrl,\n  image_url: imageUrl,\n  duration: duration\n};"},"id": "aggregator-node","name": "Scene Data","type": "n8n-nodes-base.code","typeVersion": 2,"position": [ 1560, -100 ]},{"parameters": {"jsCode": "// Master Timeline Calculator\nconst scenes = $input.all();\nlet timelineElements = [];\nlet currentTime = 0;\n\nfor (const item of scenes) {\n  const scene = item.json;\n  timelineElements.push({\n    type: "image",\n    track: 1,\n    time: currentTime,\n    duration: scene.duration,\n    source: scene.image_url\n  });\n  timelineElements.push({\n    type: "audio",\n    track: 2,\n    time: currentTime,\n    source: scene.audio_url\n  });\n  currentTime += scene.duration;\n}\nreturn { timeline: timelineElements };"},"id": "timeline-node","name": "Timeline Calculator","type": "n8n-nodes-base.code","typeVersion": 2,"position": [ 1800, 0 ]}],"connections": {"Start": { "main": [[{ "node": "AI Script Generator", "type": "main", "index": 0 }]] },"AI Script Generator": { "main": [[{ "node": "Parse JSON", "type": "main", "index": 0 }]] },"Parse JSON": { "main": [[{ "node": "Split Scenes Loop", "type": "main", "index": 0 }]] },"Split Scenes Loop": { "main": [[{ "node": "ElevenLabs (Binary)", "type": "main", "index": 0 }], [{ "node": "Timeline Calculator", "type": "main", "index": 0 }]] },"ElevenLabs (Binary)": { "main": [[{ "node": "Upload Audio to S3", "type": "main", "index": 0 }]] },"Upload Audio to S3": { "main": [[{ "node": "Start Image Gen", "type": "main", "index": 0 }]] },"Start Image Gen": { "main": [[{ "node": "Wait for Gen", "type": "main", "index": 0 }]] },"Wait for Gen": { "main": [[{ "node": "Get Image URL", "type": "main", "index": 0 }]] },"Get Image URL": { "main": [[{ "node": "Scene Data", "type": "main", "index": 0 }]] },"Scene Data": { "main": [[{ "node": "Split Scenes Loop", "type": "main", "index": 0 }]] }}}